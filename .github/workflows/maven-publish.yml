name: Publish package to GitHub Packages on Push

on:
        push:
                branches: [ main ]

jobs:
        build:
                runs-on: ubuntu-latest
                permissions:
                        contents: read
                        packages: write

                steps:
                        - uses: actions/checkout@v4
                        - name: Set up JDK 17
                          uses: actions/setup-java@v4
                          with:
                                  java-version: '17'
                                  distribution: 'temurin'
                                  server-id: github # Must match the server-id in pom.xml

                        - name: Publish to GitHub Packages
                          run: mvn deploy
                          env:
                                  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}